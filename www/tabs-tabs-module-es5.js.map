{"version":3,"sources":["webpack:///src/app/tabs/tabs.page.html","webpack:///src/app/guards/automatic-login.guard.ts","webpack:///src/app/tabs/tabs.page.ts","webpack:///src/app/tabs/tabs.page.scss","webpack:///src/app/tabs/tabs.module.ts","webpack:///src/app/tabs/tabs-routing.module.ts","webpack:///src/app/services/auth.service.ts"],"names":["AutomaticLoginGuard","_route","_auth","route","user","pipe","console","log","providedIn","TabsPage","selector","template","TabsPageModule","imports","declarations","redirectUnauthorizedToLogin","routes","path","loadChildren","then","m","LoginPageModule","canActivate","component","children","data","Tab1PageModule","BiketourDetailPageModule","TourismDetailPageModule","EventDetailPageModule","Tab2PageModule","ProductDetailPageModule","CheckoutPageModule","OrdersPageModule","redirectTo","pathMatch","Tab3PageModule","CartModalPageModule","TabsPageRoutingModule","forChild","AuthService","_afAuth","_db","_navCtrl","_storage","authState","doc","uid","valueChanges","credentials","signInWithEmailAndPassword","email","password","fullname","createUserWithEmailAndPassword","credential","updateUserData","name","image","userRef","displayName","photoURL","set","merge","signOut","navigateRoot","auth","currentUser","getUserId","base64String","filePath","fileRef","ref","task","putString","contentType","result","getDownloadURL","uploadPromise"],"mappings":"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","file":"tabs-tabs-module-es5.js","sourcesContent":["export default \"<ion-tabs>\\n\\n  <ion-tab-bar slot=\\\"bottom\\\">\\n    \\n    <ion-tab-button tab=\\\"tab1\\\">\\n      <ion-icon name=\\\"home\\\"></ion-icon>\\n    </ion-tab-button>\\n\\n    <ion-tab-button tab=\\\"tab2\\\">\\n      <ion-icon name=\\\"cart\\\"></ion-icon>\\n    </ion-tab-button>\\n\\n    <ion-tab-button tab=\\\"tab3\\\">\\n      <ion-icon name=\\\"person\\\"></ion-icon>\\n    </ion-tab-button>\\n  </ion-tab-bar>\\n\\n</ion-tabs>\\n\";","import { Injectable } from '@angular/core';\nimport { ActivatedRouteSnapshot, CanActivate, Router, RouterStateSnapshot, UrlTree } from '@angular/router';\nimport { Observable } from 'rxjs';\nimport { map, take } from 'rxjs/operators';\nimport { AuthService } from '../services/auth.service';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class AutomaticLoginGuard implements CanActivate {\n\n  constructor(\n    private _route: Router,\n    private _auth: AuthService\n  ){}\n\n  canActivate(\n    route: ActivatedRouteSnapshot\n    ):Observable<boolean>\n    {\n      return this._auth.user.pipe(\n        take(1),\n        map(user => {\n          console.log('user automatically logged:', user);\n          if(!user){\n            return true;\n          } else {\n            return false;\n          }\n        })\n      );\n  }\n\n\n  \n}\n","import { Component } from '@angular/core';\n\n@Component({\n  selector: 'app-tabs',\n  templateUrl: 'tabs.page.html',\n  styleUrls: ['tabs.page.scss']\n})\nexport class TabsPage {\n\n  constructor() {}\n\n}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJ0YWJzLnBhZ2Uuc2NzcyJ9 */\";","import { IonicModule } from '@ionic/angular';\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { TabsPageRoutingModule } from './tabs-routing.module';\n\nimport { TabsPage } from './tabs.page';\n\n@NgModule({\n  imports: [\n    IonicModule,\n    CommonModule,\n    FormsModule,\n    TabsPageRoutingModule\n  ],\n  declarations: [TabsPage]\n})\nexport class TabsPageModule {}\n","import { AngularFireAuthGuard, redirectUnauthorizedTo } from '@angular/fire/auth-guard';\nimport { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { TabsPage } from './tabs.page';\nimport { AutomaticLoginGuard } from '../guards/automatic-login.guard';\n\n//In here we asure that unauthorized user are send back to login page\nconst redirectUnauthorizedToLogin = () => redirectUnauthorizedTo(['/']);\n\nconst routes: Routes = [\n  {\n    /* Changing the \"tabs/tab1\" on redirectTo to \"login\" we make sure that \n    the default page visited is the LOGIN screen */\n    path: '',\n    loadChildren: () => import('../pages/login/login.module').then( m => m.LoginPageModule),\n    canActivate: [AutomaticLoginGuard]\n  }\n  ,\n  {\n    path: 'tabs',\n    component: TabsPage,\n    children: [\n      {\n        path: 'tab1',\n        canActivate: [AngularFireAuthGuard],\n        data: {redirectUnauthorizedToLogin},\n        children:\n        [\n          {\n          path:'',\n          loadChildren: () => import('../tab1/tab1.module').then(m => m.Tab1PageModule)\n          }\n          ,\n          {// With this we make sure that the activitydetail page is mantained even when clicking on TAB2 or TAB3\n          // also the footer tabs are reachable when we go from HOME PAGE to BIKETOURS DETAIL page\n          path: 'biketour-detail/:biketourID', //variable as a placeholder to hold the ID value\n          loadChildren: () => import('../pages/biketour-detail/biketour-detail.module').then( m => m.BiketourDetailPageModule)\n          }\n          ,\n          {// With this we make sure that the tourismdetail page is mantained even when clicking on TAB2 or TAB3\n          // also the footer tabs are reachable when we go from HOME PAGE to TOURISM DETAIL page\n          path: 'tourism-detail/:tourismID', //variable as a placeholder to hold the ID value\n          loadChildren: () => import('../pages/tourism-detail/tourism-detail.module').then( m => m.TourismDetailPageModule)\n          }\n          ,\n          {// With this we make sure that the eventdetail page is mantained even when clicking on TAB2 or TAB3\n          // also the footer tabs are reachable when we go from HOME PAGE to EVENT DETAIL page\n          path: 'event-detail/:eventID', //variable as a placeholder to hold the ID value\n          loadChildren: () => import('../pages/event-detail/event-detail.module').then( m => m.EventDetailPageModule)\n          }\n        ]\n      },\n      {\n        path: 'tab2',\n        canActivate: [AngularFireAuthGuard],\n        data: {redirectUnauthorizedToLogin},\n        children: \n        [\n          {\n            path:'',\n            loadChildren: () => import('../tab2/tab2.module').then(m => m.Tab2PageModule)\n          }\n          ,\n          {\n            path:'product-detail/:id',\n            loadChildren: () => import('../pages/product-detail/product-detail.module').then( m => m.ProductDetailPageModule)\n          }\n          ,\n          {\n            path: 'checkout',\n            loadChildren: () => import('../pages/checkout/checkout.module').then( m => m.CheckoutPageModule)\n          }\n          ,\n          {\n            path: 'orders',\n            loadChildren: () => import('../pages/orders/orders.module').then( m => m.OrdersPageModule)\n          }\n          ,\n          {\n            path: '',\n            redirectTo: 'list',\n            pathMatch: 'full'\n          }\n        ]\n      },\n      /* {\n        path:'product-detail',\n        loadChildren: () => import('../pages/product-detail/product-detail.module').then( m => m.ProductDetailPageModule)\n      }\n      ,\n      {\n        path:'product-detail/:id',\n        loadChildren: () => import('../pages/product-detail/product-detail.module').then( m => m.ProductDetailPageModule)\n      }\n      , */\n      {\n        path: 'tab3',\n        canActivate: [AngularFireAuthGuard],\n        data: {redirectUnauthorizedToLogin},\n        loadChildren: () => import('../tab3/tab3.module').then(m => m.Tab3PageModule)\n      },\n      {\n        path: '',\n        redirectTo: '/tabs/tab1',\n        pathMatch: 'full'\n      }\n    ]\n  },\n  {\n    path: 'cart-modal',\n    loadChildren: () => import('../pages/cart-modal/cart-modal.module').then( m => m.CartModalPageModule)\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n})\nexport class TabsPageRoutingModule {}\n","import { Injectable } from '@angular/core';\n\n//For hanlde authorizations\nimport { AngularFireAuth } from '@angular/fire/auth';\nimport { AngularFirestore, AngularFirestoreDocument } from '@angular/fire/firestore';\n\nimport { Observable, from, of } from 'rxjs';\nimport { switchMap } from 'rxjs/operators';\nimport { NavController } from '@ionic/angular';\n\n//import * as firebase from 'firebase/app';\nimport { firebase } from '@firebase/app'\nimport '@firebase/auth';\n\n// To upload data (images ofr example)\nimport { AngularFireStorage, AngularFireUploadTask } from '@angular/fire/storage';\n\n\n//Interface for User\nexport interface User{\n  uid: string;\n  email: string;\n  photoURL?: string;\n  displayName: string\n}\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class AuthService {\n\n  user: Observable<any>;\n\n  constructor(\n    private _afAuth: AngularFireAuth,\n    private _db: AngularFirestore, \n    private _navCtrl: NavController,\n    private _storage: AngularFireStorage\n    ) {\n    this.user = this._afAuth.authState.pipe(\n      switchMap(user => {\n        if (user) {\n          return this._db.doc(`users/${user.uid}`).valueChanges();\n        } else {\n          return of(null);\n        }\n      })\n    )\n  }\n\n  signIn(credentials): Observable<any> {\n    return from(this._afAuth.signInWithEmailAndPassword(credentials.email, credentials.password)).pipe(\n      switchMap(user => {\n        console.log('real user: ', user);\n        if (user) {\n          return this._db.doc(`users/${user.user.uid}`).valueChanges();\n        } else {\n          return of(null);\n        }\n      })\n    )\n  }\n\n  /* signUp(credentials) {\n    return this._afAuth.createUserWithEmailAndPassword(credentials.email, credentials.password).then(data => {\n      console.log('after register: ', data);\n      return this._db.doc(`users/${data.user.uid}`).set({\n        name: credentials.name,\n        email: credentials.email,\n        password: credentials.password\n      });\n    });\n  } */\n\n  //Method to regster as new user\n  async signUp({email, password, fullname}): Promise<any> {\n    const credential = await this._afAuth.createUserWithEmailAndPassword(\n    email,\n    password\n    );\n    return this.updateUserData(credential.user, fullname);\n    }\n\n\n  // Sets user data to firestore on login\n  private updateUserData(user: User, name = null, image = null): Promise<any> {\n    const userRef: AngularFirestoreDocument<User> = this._db.doc(`users/${user.uid}`);\n    \n    const data = {\n    uid: user.uid,\n    email: user.email,\n    displayName: name,\n    photoURL: image,\n  };\n  return userRef.set(data, { merge: true });\n  }\n\n  //Mehtod for sign out the application\n  signOut() {\n    this._afAuth.signOut().then(() => {\n      this._navCtrl.navigateRoot('/');\n    });\n  }\n\n  //Method to get the user ID\n  getUserId(){\n    return firebase.auth().currentUser.uid;\n  }\n\n  //Methos to get the user DATA\n  getUserData(){\n    return this._db.doc<User>(`users/${this.getUserId()}`).valueChanges();\n  }\n\n  //Method to load the image on the profile tab\n  uploadAvatar(base64String) {\n\n    const filePath = `${this.getUserId()}/avatar`;\n    const fileRef = this._storage.ref(filePath);\n    const task: AngularFireUploadTask = fileRef.putString(base64String,'base64', { contentType: 'image/png' });\n\n    return from(task).pipe(\n    switchMap(result => {\n    // Upload Task finished, get URL to the image\n    return fileRef.getDownloadURL();\n    }),\n    switchMap(photoURL => {\n    // Set the URL to the user document\n    const uploadPromise = this._db\n    .doc(`users/${this.getUserId()}`)\n    .set({ photoURL }, { merge: true });\n    return from(uploadPromise);\n    })\n    )\n  }\n\n  getEmail(){\n    return firebase.auth().currentUser.email;\n  }\n}"]}